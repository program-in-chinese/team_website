---
layout: post
comments: true
title:  ä¸­æ–‡å‘½åä¹‹Hibernate 5æ¼”ç¤º - ä½¿ç”¨æ³¨è§£(annotation)è€Œéxmlå®šä¹‰æ˜ å°„
description: ç”¨ä¸€ä¸ªç®€å•ä¾‹å­æ¼”ç¤ºHibernate 5 + MySQLåŸºæœ¬åŠŸèƒ½ä¸­ä½¿ç”¨ä¸­æ–‡å‘½å.
date:   2019-05-14 00:00:00 -0700
categories: å‘½å Hibernate
---

![2019-05-14-hibernateAnnotation]({{ "/assets/2019-05-14-hibernateAnnotation.png" | absolute_url }})

å‰æ–‡[ä¸­æ–‡ç¼–ç¨‹ï¼šä¸­æ–‡å‘½åä¹‹Hibernate 4+MySQLæ¼”ç¤º](https://zhuanlan.zhihu.com/p/63518209)æœ€åç•™ä¸‹äº†ä¸ªHibernate 5ä¹‹åå‡ºç°çš„é—®é¢˜, äºæ˜¯åœ¨Hibernateç¤¾åŒºæäº¤äº†æŠ¥å‘Š: [Seemingly regression since Hibernate 5: unicode support for class name in XML mapping file](https://hibernate.atlassian.net/browse/HHH-13383)

å¼€å‘ç»„(ğŸ‘Gail Badner)ååº”å¾ˆå¿«, ä¸€åŒç¡®è®¤äº†å½“å‰ç¨³å®šç‰ˆ5.4.2.Finalå’Œæœ€æ–°çš„6.0.0.Alpha2éƒ½æœ‰æ­¤é—®é¢˜, å¹¶ä¸”åŸºäºå®˜æ–¹æµ‹è¯•ç”¨ä¾‹[é‡ç°äº†é—®é¢˜](https://github.com/nobodxbodon/hibernate-test-case-templates/commit/b3d805b7abe848b27c7370c2409baecb296d2136). åˆæ­¥è¯Šæ–­ç—…å› æ˜¯è¿™ä¸ª[xsdçº¦æŸ](https://github.com/hibernate/hibernate-orm/blob/b7b8f44298191db050f12819ca0594a30124df75/hibernate-core/src/main/resources/org/hibernate/xsd/mapping/legacy-mapping-4.0.xsd#L2073)(***å¯ä»¥ç»§ç»­æ·±ç©¶ä¸€ä¸‹æºå¤´, å¦‚æœæ˜¯ä»å…¶ä»–åœ°æ–¹æ‹·è´è¿‡æ¥çš„è¯***). å°†æ­¤é—®é¢˜æ·»åŠ åˆ°äº†5.4ç‰ˆæœ¬çš„å¾…ä¿®å¤é—®é¢˜åˆ—è¡¨, å¹¶å»ºè®®ç”¨æ³¨è§£(annotation)è€Œä¸æ˜¯xmlé…ç½®. ç»æµ‹è¯•çš„ç¡®å¯é€šè¿‡æ³¨è§£æ”¯æŒä¸å‰æ–‡ç›¸åŒçš„ä¸­æ–‡å‘½å.

å®Œæ•´æºç åœ¨æ­¤åˆ†æ”¯: [nobodxbodon/HibernateExampleZh](https://github.com/nobodxbodon/HibernateExampleZh/tree/annotation)

å¸¦æ³¨è§£çš„Javaæºç :
```java
@Entity
@Table(name="å®¢æˆ·")
public class å®¢æˆ·ç±» implements java.io.Serializable {

  private Long å®¢æˆ·_ID;
  private String å§“å;
  private Date åˆ›å»ºæ—¥æœŸ;

  public å®¢æˆ·ç±»() {
  }

  public å®¢æˆ·ç±»(String å§“å, Date åˆ›å»ºæ—¥æœŸ) {
      this.å§“å = å§“å;
      this.åˆ›å»ºæ—¥æœŸ = åˆ›å»ºæ—¥æœŸ;
  }

  @Id
  @GeneratedValue(strategy=GenerationType.IDENTITY)
  @Column(name = "å®¢æˆ·_ID", length=20)
  public Long getå®¢æˆ·Id() {
      return this.å®¢æˆ·_ID;
  }

  public void setå®¢æˆ·Id(Long å®¢æˆ·Id) {
      this.å®¢æˆ·_ID = å®¢æˆ·Id;
  }

  @Column(name = "å§“å", nullable = false, length=45)
  public String getå§“å() {
      return this.å§“å;
  }

  public void setå§“å(String å§“å) {
      this.å§“å = å§“å;
  }

  @Column(name = "åˆ›å»ºæ—¥æœŸ", nullable = false, length=19)
  public Date getåˆ›å»ºæ—¥æœŸ() {
      return this.åˆ›å»ºæ—¥æœŸ;
  }

  public void setåˆ›å»ºæ—¥æœŸ(Date åˆ›å»ºæ—¥æœŸ) {
      this.åˆ›å»ºæ—¥æœŸ = åˆ›å»ºæ—¥æœŸ;
  }

  @Override
  public String toString() {
    return å®¢æˆ·_ID + " " + å§“å + " " + åˆ›å»ºæ—¥æœŸ;
  }

}
```
åœ¨Hibernateé…ç½®æ–‡ä»¶ä¸­æŒ‡å®šç±», è€Œéxmlæ˜ å°„æ–‡ä»¶:
```xml
		<mapping class="com.codeinchinese.å®¢æˆ·.æ¨¡å‹.å®¢æˆ·ç±»"></mapping>
```
æœŸé—´ç¢°åˆ°ä¸€ä¸ªé—®é¢˜:

> Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'Ã¥Â®Â¢Ã¦Ë†Â·Ã§Â±Â»0_.Ã¥Â®Â¢Ã¦Ë†Â·Id' in 'field list'

æ˜¯ç”±äºidçš„é»˜è®¤æ•°æ®åº“åˆ—åä¸ºId, è€Œæ•°æ®åº“ä¸­ä½¿ç”¨äº†å®¢æˆ·_IDä½œä¸ºåˆ—å. æ·»åŠ å¦‚ä¸‹æ³¨è§£åè§£å†³:
```java
  @Column(name = "å®¢æˆ·_ID", length=20)
```
#### å‚è€ƒ

[Chapter 2. Mapping Entities](https://docs.jboss.org/hibernate/stable/annotations/reference/en/html/entity.html)

[org.hibernate.MappingException: Unknown entity: annotations.Users](https://stackoverflow.com/questions/23214454/org-hibernate-mappingexception-unknown-entity-annotations-users)
